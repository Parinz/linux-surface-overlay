"use strict";(self.webpackChunksurface_gentoo_docs=self.webpackChunksurface_gentoo_docs||[]).push([[689],{3905:function(e,n,t){t.d(n,{Zo:function(){return p},kt:function(){return m}});var r=t(7294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var s=r.createContext({}),c=function(e){var n=r.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},p=function(e){var n=c(e.components);return r.createElement(s.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},g=r.forwardRef((function(e,n){var t=e.components,o=e.mdxType,a=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),g=c(t),m=o,d=g["".concat(s,".").concat(m)]||g[m]||u[m]||a;return t?r.createElement(d,i(i({ref:n},p),{},{components:t})):r.createElement(d,i({ref:n},p))}));function m(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var a=t.length,i=new Array(a);i[0]=g;var l={};for(var s in n)hasOwnProperty.call(n,s)&&(l[s]=n[s]);l.originalType=e,l.mdxType="string"==typeof e?e:o,i[1]=l;for(var c=2;c<a;c++)i[c]=t[c];return r.createElement.apply(null,i)}return r.createElement.apply(null,t)}g.displayName="MDXCreateElement"},9185:function(e,n,t){t.r(n),t.d(n,{frontMatter:function(){return l},contentTitle:function(){return s},metadata:function(){return c},toc:function(){return p},default:function(){return g}});var r=t(2122),o=t(9756),a=(t(7294),t(3905)),i=["components"],l={sidebar_position:2},s="Adding the Linux-Surface Overlay",c={unversionedId:"Installing-Gentoo/2",id:"Installing-Gentoo/2",isDocsHomePage:!1,title:"Adding the Linux-Surface Overlay",description:"After connecting to network on the live environment, you can go to the Gentoo Handbook.",source:"@site/docs/Installing-Gentoo/2.md",sourceDirName:"Installing-Gentoo",slug:"/Installing-Gentoo/2",permalink:"/linux-surface-overlay/docs/Installing-Gentoo/2",editUrl:"https://github.com/facebook/docusaurus/edit/master/website/docs/Installing-Gentoo/2.md",version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"Creating & Booting the Live USB",permalink:"/linux-surface-overlay/docs/Installing-Gentoo/1"},next:{title:"Create a Blog Post",permalink:"/linux-surface-overlay/docs/Installing-Gentoo/create-a-blog-post"}},p=[{value:"Emerging Eselect Repository",id:"emerging-eselect-repository",children:[]},{value:"Installing the Sources",id:"installing-the-sources",children:[]},{value:"Manual Configuration",id:"manual-configuration",children:[{value:"Making sure wifi works",id:"making-sure-wifi-works",children:[]}]}],u={toc:p};function g(e){var n=e.components,t=(0,o.Z)(e,i);return(0,a.kt)("wrapper",(0,r.Z)({},u,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"adding-the-linux-surface-overlay"},"Adding the Linux-Surface Overlay"),(0,a.kt)("p",null,"After connecting to network on the live environment, you can go to the ",(0,a.kt)("a",{parentName:"p",href:"https://wiki.gentoo.org/wiki/Handbook:AMD64"},"Gentoo Handbook"),"."),(0,a.kt)("p",null,"Since we already did some things, you can skip right to the ",(0,a.kt)("strong",{parentName:"p"},'"Preparing the disks section"')),(0,a.kt)("p",null,"Continue following it until you get to ",(0,a.kt)("strong",{parentName:"p"},'"Configuring the Linux kernel ',(0,a.kt)("em",{parentName:"strong"},"(Don't actually do the step)"),'"')," and stop there."),(0,a.kt)("h2",{id:"emerging-eselect-repository"},"Emerging Eselect Repository"),(0,a.kt)("p",null,"In order to access any ",(0,a.kt)("a",{parentName:"p",href:"https://wiki.gentoo.org/wiki/Ebuild_repository"},"overlays"),", you have to use tools such as ",(0,a.kt)("strong",{parentName:"p"},(0,a.kt)("em",{parentName:"strong"},"layman"))," or ",(0,a.kt)("strong",{parentName:"p"},(0,a.kt)("em",{parentName:"strong"},"eselect-repository")),". We will be using the latter in this guide."),(0,a.kt)("p",null,"Installing ",(0,a.kt)("em",{parentName:"p"},"eselect-repository"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"emerge --ask app-eselect/eselect-repository\n")),(0,a.kt)("p",null,"Setup:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"mkdir -p /etc/portage/repos.conf\n")),(0,a.kt)("p",null,"Enable the ",(0,a.kt)("em",{parentName:"p"},"linux-surface-overlay"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"eselect repository -f\neselect repository enable linux-surface\n")),(0,a.kt)("h2",{id:"installing-the-sources"},"Installing the Sources"),(0,a.kt)("p",null,"This part of the guide is similar to ",(0,a.kt)("strong",{parentName:"p"},'"Configuring the Linux kernel"')," section from the handbook. Please also read the handbook counterpart to understand the commands shown below."),(0,a.kt)("p",null,'The first line is to tell portage that we want to install "testing version". Otherwise it will pull in an LTS kernel (5.10). If you do want the LTS kernel, omit the first line.'),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"echo sys-kernel/surface-sources ~amd64 >> /etc/portage/package.accept_keywords\nemerge --ask sys-kernel/surface-sources\n")),(0,a.kt)("p",null,"Selecting the kernel:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"eselect kernel list\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"eselect kernel set 1 (Or whatever number the surface kernel is)\n")),(0,a.kt)("h2",{id:"manual-configuration"},"Manual Configuration"),(0,a.kt)("p",null,"Unfortunately, you have to manually configure your kernel in this case and there is no other option. So let's go."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"cd /usr/src/linux\nmake nconfig\n")),(0,a.kt)("p",null,"Yes, that second command is correct. We will be using ",(0,a.kt)("inlineCode",{parentName:"p"},"nconfig")," instead of ",(0,a.kt)("inlineCode",{parentName:"p"},"menuconfig"),"."),(0,a.kt)("p",null,"You should see the menu with a lot of stuff on it. (Don't feel overwhelmed). For more information on how to configure your kernel you can look at ",(0,a.kt)("a",{parentName:"p",href:"https://wiki.gentoo.org/wiki/Kernel/Gentoo_Kernel_Configuration_Guide"},"this part of the gentoo handbook. I highly recommend you to.")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},(0,a.kt)("em",{parentName:"strong"},"Warning, these options are only Surface Specific. For more configuration details please look at the link above and/or the chapter."))),(0,a.kt)("h3",{id:"making-sure-wifi-works"},"Making sure wifi works"),(0,a.kt)("p",null,"Exit out of menuconfig and identify your wifi chipset by running this command:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"emerge --ask sys-apps/pciutils\nlspci -k | more\n")),(0,a.kt)("p",null,"Try to find a line that begins with ",(0,a.kt)("inlineCode",{parentName:"p"},"Network controller"),". You should the vendor name after it such as: ",(0,a.kt)("inlineCode",{parentName:"p"},"Marvell")," or ",(0,a.kt)("inlineCode",{parentName:"p"},"Intel"),". Take note of the wifi card."),(0,a.kt)("p",null,"Firstly, you need cfg80211 and mac80211 as ",(0,a.kt)("em",{parentName:"p"},"modules"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"[*] Networking support  ---\x3e\n    [*] Wireless  ---\x3e\n        <M>   cfg80211 - wireless configuration API\n        [ ]     nl80211 testmode command\n        [ ]     enable developer warnings\n        [ ]     cfg80211 certification onus\n        [*]     enable powersave by default\n        [ ]     cfg80211 DebugFS entries\n        [ ]     support CRDA\n        [ ]     cfg80211 wireless extensions compatibility\n        <M>   Generic IEEE 802.11 Networking Stack (mac80211)\n        [*]   Minstrel\n        [*]     Minstrel 802.11n support\n        [ ]       Minstrel 802.11ac support\n              Default rate control algorithm (Minstrel)  ---\x3e\n        [ ]   Enable mac80211 mesh networking (pre-802.11s) support\n        -*-   Enable LED triggers\n        [ ]   Export mac80211 internals in DebugFS\n        [ ]   Trace all mac80211 debug messages\n        [ ]   Select mac80211 debugging features  ----\n")),(0,a.kt)("p",null,"If your ",(0,a.kt)("strong",{parentName:"p"},"wifi uses")," ",(0,a.kt)("em",{parentName:"p"},"Wext")," encryption:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"[*] Networking support  ---\x3e\n    [*] Wireless  ---\x3e\n        [*]     cfg80211 wireless extensions compatibility\n")),(0,a.kt)("p",null,"Now enable your wifi-card option and also the ",(0,a.kt)("em",{parentName:"p"},"AES Cipher"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"Device Drivers  ---\x3e\n    [*] Network device support  ---\x3e\n        [*] Wireless LAN  ---\x3e\n        \n        Enable the option for your wifi card: (Ex: Intel Card)\n            [ ]   mac80211-based legacy WDS support\n            [ ]   ADMtek devices\n            [ ]   Atheros/Qualcomm devices\n            [ ]   Atmel devices\n            [ ]   Broadcom devices\n            [ ]   Cisco devices\n            [*]   Intel devices\n            <M>     Intel PRO/Wireless 2100 Network Connection\n            <M>     Intel PRO/Wireless 2200BG and 2915ABG Network Connection\n            <M>     Intel Wireless WiFi 4965AGN (iwl4965)\n            <M>     Intel PRO/Wireless 3945ABG/BG Network Connection (iwl3945)\n            <M>     Intel Wireless WiFi Next Gen AGN - Wireless-N/Advanced-N/Ultimate-N (iwlwifi)\n            <M>       Intel Wireless WiFi DVM Firmware support\n            <M>       Intel Wireless WiFi MVM Firmware support\n                      Debugging Options  ---\x3e\n            [ ]   Intersil devices\n            [ ]   Marvell devices\n            [ ]   MediaTek devices\n            [ ]   Ralink devices\n            [ ]   Realtek devices\n            [ ]   Redpine Signals Inc devices\n            [ ]   STMicroelectronics devices\n            [ ]   Texas Instrument devices\n            [ ]   ZyDAS devices\n            [ ]   Quantenna wireless cards support\n            < >   Simulated radio testing tool for mac80211\n            < >   Wireless RNDIS USB support\n\n-*- Cryptographic API ---\x3e\n    -*- AES cipher algorithms\n    -*- AES cipher algorithms (x86_64)\n    <*> AES cipher algorithms (AES-NI)\n")),(0,a.kt)("p",null,"Once again you should also be looking at the ",(0,a.kt)("strong",{parentName:"p"},"Handbook for configuring the kernel")," along side this one."),(0,a.kt)("p",null,"Next we will move on to Surface specifics.\n//TODO"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"You can go back to the Handbook and follow it until the part where you compile and install the kernel. You also ",(0,a.kt)("em",{parentName:"strong"},"NEED")," to create an initramfs.")),(0,a.kt)("p",null,"After creating the initramfs, you need to install the linux-firmware package."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"emerge --ask sys-kernel/linux-firmware\n")),(0,a.kt)("p",null,"Also check ",(0,a.kt)("a",{parentName:"p",href:"https://wiki.gentoo.org/wiki/Wifi#Firmware"},"here to see")," to see if your wifi-card matches so you can emerge the specific package."),(0,a.kt)("p",null,"You can now skip forward to the next part of the Handbook and this guide."))}g.isMDXComponent=!0}}]);